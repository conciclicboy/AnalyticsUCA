y_train<-train_set$Truck
y_test<- test_set$Truck
############### PUEDE MODIFICAR VARIABLE DEPENDIENTE ###########
########## alpha= 0 para Ridge Reg / alpha =1 para Lasso #########
model_2<-cv.glmnet(as.matrix(X_train),as.matrix(y_train),
family="gaussian", alpha = 1, nlambda=15)
########## alpha= 0 para Ridge Reg / alpha =1 para Lasso #########
####################### NO TOCAR ######################
# Sacando predicciones
pred_train_2=predict(model_2, newx = as.matrix(X_train), s = "lambda.min")
pred_test_2=predict(model_2, newx = as.matrix(X_test), s = "lambda.min")
#Mean Absolute Error
mae_train2<-mae(y_train,pred_train_2)
mae2<-mae(y_test,pred_test_2)
# reportando errores
print(paste("train set: ",mae_train2))
print(paste("test set: ",mae2))
####################### NO TOCAR ######################
# Imprimiendo resultado
#knitr::kable(xtable(summary(model_2)))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Tomaremos los datos desde Septiembre 2009 hasta el final
# Como ya estÃ¡n ordenados solo agarro de la fila 187 hasta el final
visualize(dataset=b[187:nrow(b),],
xvar=c("Inventories", "CPI_New_Cars", "CPI_Used_Cars",
"Gas_Prices", "Cons_Conf_Autos", "Miles_Driven"),
yvar="Truck",
type="scatter",
custom=FALSE
)
visualize(dataset=b[187:nrow(b),],
xvar=c("Bank_Auto_Interest_Rate", "US_Population_millions", "Unemployment",
"Disposible_Income_Capita_Real", "Saving_Capital", "Household_Debt_Capital"),
yvar="Truck",
type="scatter",
custom=FALSE
)
visualize(dataset=b[187:nrow(b),],
xvar=c("US_House_Price_Inflation", "Consumer_Confidence", "RealGDP",
"Fed_Funds_Rate", "US_Urban_CPI_Change", "Nonfarm_Payrolls"),
yvar="Truck",
type="scatter",
custom=FALSE
)
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+Consumer_Confidence+ RealGDP+ Fed_Funds_Rate+
Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+Consumer_Confidence+ RealGDP+
Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_3<- lm(Truck ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Sacando predicciones
pred_train_3<-predict(model_3,train_set)
pred_test_3<-predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Truck,pred_test_3)
mae_train3<-mae(train_set$Truck,pred_train_3)
#Reportando
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Modelo
model_1<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
#CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
#US_Population_millions+ Unemployment+
#Disposible_Income_Capita_Real+ Saving_Capital+
#Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
#US_Urban_CPI_Change+ Nonfarm_Payrolls,
Inventories+CPI_New_Cars+CPI_Used_Cars+Gas_Prices+
Cons_Conf_Autos+Miles_Driven+Bank_Auto_Interest_Rate+
US_Population_millions+Unemployment+Disposible_Income_Capita_Real+
Saving_Capital+ Household_Debt_Capital+US_House_Price_Inflation+
Consumer_Confidence+RealGDP+Fed_Funds_Rate+US_Urban_CPI_Change+
Nonfarm_Payrolls,
data=train_set)
# Imprimiendo resultado
knitr::kable(xtable(summary(model_1)))
library(Metrics)
#train_set<-b[year(b$Date)< 2017,]
#test_set<-b[year(b$Date) >= 2017,]
# Sacando predicciones
pred_train_1<-predict(model_1,train_set)
pred_test_1<-predict(model_1,test_set)
#Mean Absolute Error
mae1<-mae(test_set$Car,pred_test_1)
mae_train1<-mae(train_set$Car,pred_train_1)
print(paste("Train Error: ",mae_train1))
print(paste("Test Error: ",mae1))
