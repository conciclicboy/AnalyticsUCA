model_1<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Imprimiendo resultado
knitr::kable(xtable(summary(model_1)))
library(Metrics)
# Sacando predicciones
pred_train_1<-predict(model_1,train_set)
pred_test_1<-predict(model_1,test_set)
#Mean Absolute Error
mae1<-mae(test_set$Car,pred_test_1)
mae_train1<-mae(train_set$Car,pred_train_1)
print(paste("Train Error: ",mae_train1))
print(paste("Test Error: ",mae1))
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_aic(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Sacando predicciones
pred_train_2=predict(model_2,train_set)
pred_test_2=predict(model_2,test_set)
#Mean Absolute Error
mae_train2<-mae(train_set$Car,pred_train_2)
mae2<-mae(test_set$Car,pred_test_2)
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_aic(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2=predict(model_2,train_set)
pred_test_2=predict(model_2,test_set)
#Mean Absolute Error
mae_train2<-mae(train_set$Car,pred_train_2)
mae2<-mae(test_set$Car,pred_test_2)
#Reportando Errrores
print(paste("Train Error: ",mae_train1))
print(paste("Test Error: ",mae1))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_aic(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Creando modelo: stepwise backward regression
temporal<-ols_step_forward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
View(b)
model_2<- lm(Car ~ Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
#temporal<-ols_step_forward_p(model_1)
#model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
model_2<- lm(Car ~ Time, Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
model_2<- lm(Car ~ Time+Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
#temporal<-ols_step_forward_p(model_1)
#model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Creando modelo
#model_1<- lm(formula = price ~ room_type + neighborhood +
#             reviews +overall_satisfaction + accommodates +
#             bedrooms,data = train_set)
# Sacando predicciones
#pred_train_1=predict(model_1,train_set)#entrenamiento
#pred_test_1=predict(model_1,test_set)#evaluación
# Reportando modelo: usted solo necesita poner "summary(model)"
# Eso le entrega los resultados del modelo pero se imprime en formato feo
# Nosotros lo vamos a imprimir como una "xtable" en "knitr::kable"
#library(xtable)
#knitr::kable(xtable(summary(model_1)))
# Librerías de utilidad
library(olsrr)
library(xtable)
# Modelo
model_1<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Imprimiendo resultado
knitr::kable(xtable(summary(model_1)))
# Dividiendo datos en conjunto de entrenamiento y validación
# Como nuestros datos ya están ordenados por fecha es fácil hacerlo:
# usted puede simplemente tomar las primeras 274 filas y las ultimas 11
# yo utilice el año para ilustrar como se haría si no estuviera ordenado
library(lubridate)
train_set<-b[year(b$Date)< 2017,]
test_set<-b[year(b$Date) >= 2017,]
# Creando modelo
#model_1<- lm(formula = price ~ room_type + neighborhood +
#             reviews +overall_satisfaction + accommodates +
#             bedrooms,data = train_set)
# Sacando predicciones
#pred_train_1=predict(model_1,train_set)#entrenamiento
#pred_test_1=predict(model_1,test_set)#evaluación
# Reportando modelo: usted solo necesita poner "summary(model)"
# Eso le entrega los resultados del modelo pero se imprime en formato feo
# Nosotros lo vamos a imprimir como una "xtable" en "knitr::kable"
#library(xtable)
#knitr::kable(xtable(summary(model_1)))
# Librerías de utilidad
library(olsrr)
library(xtable)
# Modelo
model_1<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Imprimiendo resultado
knitr::kable(xtable(summary(model_1)))
library(Metrics)
train_set<-b[year(b$Date)< 2017,]
test_set<-b[year(b$Date) >= 2017,]
# Sacando predicciones
pred_train_1<-predict(model_1,train_set)
pred_test_1<-predict(model_1,test_set)
#Mean Absolute Error
mae1<-mae(test_set$Car,pred_test_1)
mae_train1<-mae(train_set$Car,pred_train_1)
print(paste("Train Error: ",mae_train1))
print(paste("Test Error: ",mae1))
model_2<- lm(Car ~ Time+Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
#temporal<-ols_step_forward_p(model_1)
#model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
model_2<- lm(Car ~ Time+Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_forward_p(model_2)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
model_2<- lm(Car ~ Time+Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
#temporal<-ols_step_forward_p(model_2)
#model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Modelo
model_2<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_forward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Modelo
model_2<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Modelo
model_2<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_aic(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Modelo
model_2<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_backward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Modelo
model_2<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_forward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Modelo
model_3<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Eliminando variables
#temporal<-ols_step_backward_aic(model_3)
#model_3<-temporal$model
# Sacando predicciones
pred_train_3=predict(model_3,train_set)
pred_test_3=predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Car,pred_test_3)
mae_train3<-mae(train_set$Car,pred_train_3)
# Imprimiendo resultado
knitr::kable(xtable(summary(model_3)))
# Modelo
model_3<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Eliminando variables
#temporal<-ols_step_backward_aic(model_3)
#model_3<-temporal$model
# Sacando predicciones
pred_train_3=predict(model_3,train_set)
pred_test_3=predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Car,pred_test_3)
mae_train3<-mae(train_set$Car,pred_train_3)
# Imprimiendo resultado
#knitr::kable(xtable(summary(model_3)))
# Modelo
model_3<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Eliminando variables
#temporal<-ols_step_backward_aic(model_3)
#model_3<-temporal$model
# Sacando predicciones
pred_train_3=predict(model_3,train_set)
pred_test_3=predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Car,pred_test_3)
mae_train3<-mae(train_set$Car,pred_train_3)
#Reportando errores
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
# Imprimiendo resultado
#knitr::kable(xtable(summary(model_3)))
# Modelo
model_3<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
Inventories+CPI_Used_Cars+ US_Population_millions+
Unemployment+ Disposible_Income_Capita_Real+
Household_Debt_Capital+ Consumer_Confidence+
RealGDP+ Fed_Funds_Rate+ Nonfarm_Payrolls,
data=train_set)
# Eliminando variables
#temporal<-ols_step_backward_aic(model_3)
#model_3<-temporal$model
# Sacando predicciones
pred_train_3=predict(model_3,train_set)
pred_test_3=predict(model_3,test_set)
#Mean Absolute Error
mae3<-mae(test_set$Car,pred_test_3)
mae_train3<-mae(train_set$Car,pred_train_3)
#Reportando errores
print(paste("Train Error: ",mae_train3))
print(paste("Test Error: ",mae3))
# Imprimiendo resultado
#knitr::kable(xtable(summary(model_3)))
# Modelo
model_2<- lm(Car ~ Time + Year+ Q1+ Q2+ Q3+
CPI_Used_Cars+ Gas_Prices+ Miles_Driven+
US_Population_millions+ Unemployment+
Disposible_Income_Capita_Real+ Saving_Capital+
Household_Debt_Capital+ RealGDP+ Fed_Funds_Rate+
US_Urban_CPI_Change+ Nonfarm_Payrolls,
data=train_set)
# Creando modelo: stepwise backward regression
temporal<-ols_step_forward_p(model_1)
model_2<-temporal$model
#ols_step_forward_p(model_1)
#ols_step_both_aic()
# Imprimiendo resultado
#knitr::kable(xtable(summary(model_2)))
# Sacando predicciones
pred_train_2<-predict(model_2,train_set)
pred_test_2<-predict(model_2,test_set)
#Mean Absolute Error
mae2<-mae(test_set$Car,pred_test_2)
mae_train2<-mae(train_set$Car,pred_train_2)
print(paste("Train Error: ",mae_train2))
print(paste("Test Error: ",mae2))
